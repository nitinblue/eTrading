# DEPRECATED: Active templates migrated to config/research_templates.yaml (session 24).
# This file is retained for reference. New templates should be added to research_templates.yaml.
# The 4 active scenarios (correction, earnings, black_swan, arbitrage) are now ResearchTemplates
# with generic condition evaluation instead of hardcoded screener classes.
scenario_templates:

  correction_premium_sell:
    display_name: "Market Correction — Sell Premium"
    description: "Market dropped 8-15% from highs, VIX elevated. Sell premium on quality names."
    scenario_type: correction
    enabled: true
    trigger_conditions:
      pct_from_52w_high: [-15.0, -8.0]
      vix: [22.0, 45.0]
      rsi_max: 40
      directional_regime: ["D", "F"]
    strategies:
      - strategy_type: vertical_spread
        option_type: put
        direction: sell
        dte_target: 45
        short_delta: 0.30
        wing_width_pct: 0.05
        confidence: 7
        risk_category: defined
        route_to_portfolios: [tastytrade, fidelity_ira]
      - strategy_type: strangle
        direction: sell
        dte_target: 45
        delta_target: 0.16
        confidence: 5
        risk_category: undefined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, AAPL, NVDA, MSFT]
    cadence: opportunistic
    rationale_template: "{underlying} corrected {pct_from_high:.1f}% from 52w high. VIX={vix:.1f}, RSI={rsi:.1f}. Selling premium at elevated IV."

  earnings_iv_crush:
    display_name: "Earnings IV Crush"
    description: "Sell premium before earnings when IV pumped. Profit from IV crush."
    scenario_type: earnings
    enabled: true
    trigger_conditions:
      days_to_earnings: [2, 7]
      iv_rank_min: 60
      rsi_range: [35, 65]
    strategies:
      - strategy_type: iron_condor
        dte_target: 7
        short_delta: 0.20
        wing_width_pct: 0.08
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
      - strategy_type: iron_butterfly
        dte_target: 7
        confidence: 5
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: []
    cadence: event_driven
    rationale_template: "{underlying} earnings in {days_to_earnings}d. IV rank={iv_rank:.0f}. Selling premium for IV crush."

  black_swan_hedge:
    display_name: "Black Swan / Tail Risk Hedge"
    description: "Buy protection when systemic risk elevated. Insurance, not income."
    scenario_type: black_swan
    enabled: true
    trigger_conditions:
      vix_min: 30
      pct_from_52w_high_max: -12.0
      volatility_regime: ["HIGH"]
    strategies:
      - strategy_type: single
        option_type: put
        direction: buy
        dte_target: 30
        delta_target: 0.20
        confidence: 8
        risk_category: defined
        route_to_portfolios: [fidelity_ira, tastytrade]
    underlyings: [SPY]
    cadence: triggered
    auto_approve: false
    rationale_template: "Black swan signal: VIX={vix:.1f}, {underlying} down {pct_from_high:.1f}% from high. Buying tail protection."

  vol_arbitrage_calendar:
    display_name: "Volatility Arbitrage — Calendar/Double Calendar"
    description: "Exploit IV term structure anomaly. Near IV >> far IV = sell near, buy far."
    scenario_type: arbitrage
    enabled: true
    trigger_conditions:
      iv_rank_min: 50
      volatility_regime: ["HIGH", "NORMAL"]
      bollinger_width_min: 0.04
    strategies:
      - strategy_type: calendar_spread
        option_type: call
        near_dte_target: 7
        far_dte_target: 30
        delta_target: 0.40
        confidence: 7
        risk_category: defined
        route_to_portfolios: [tastytrade, medium_risk_whatif]
      - strategy_type: calendar_double_spread
        near_dte_target: 7
        far_dte_target: 30
        put_delta: 0.35
        call_delta: 0.35
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, SPX]
    cadence: opportunistic
    rationale_template: "{underlying} IV rank={iv_rank:.0f}, Bollinger width={bollinger_width:.3f}. Calendar spread for theta + vega."

  # -------------------------------------------------------------------
  # FUTURE SCENARIOS — Enabled=false, ready for implementation
  # -------------------------------------------------------------------

  orderblock_demand_zone:
    display_name: "Order Block — Demand Zone Entry"
    description: "Price retraces into a bullish order block (institutional demand zone). Buy calls or sell put spreads at support."
    scenario_type: orderblock
    enabled: false
    trigger_conditions:
      directional_regime: ["U", "F"]
      rsi_range: [35, 55]
      # Future: requires support/resistance detection from price action
      # near_support: true  (within 2% of nearest_support)
    strategies:
      - strategy_type: vertical_spread
        option_type: put
        direction: sell
        dte_target: 30
        short_delta: 0.25
        wing_width_pct: 0.04
        confidence: 7
        risk_category: defined
        route_to_portfolios: [tastytrade]
      - strategy_type: single
        option_type: call
        direction: buy
        dte_target: 45
        delta_target: 0.50
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, AAPL, NVDA, MSFT]
    cadence: opportunistic
    rationale_template: "{underlying} retesting demand zone. RSI={rsi:.1f}, regime={directional_regime}. Entering at institutional support."

  volatility_contraction:
    display_name: "Volatility Contraction — Squeeze Play"
    description: "Bollinger Bands narrowing (squeeze). Low vol precedes big move. Buy straddles/strangles before expansion."
    scenario_type: vol_contraction
    enabled: false
    trigger_conditions:
      volatility_regime: ["LOW"]
      # bollinger_width_max: 0.03  (Future: needs max threshold trigger)
      iv_rank_min: 10
      rsi_range: [40, 60]
    strategies:
      - strategy_type: strangle
        direction: buy
        dte_target: 30
        delta_target: 0.30
        confidence: 5
        risk_category: defined
        route_to_portfolios: [tastytrade]
      - strategy_type: calendar_spread
        option_type: call
        near_dte_target: 7
        far_dte_target: 45
        delta_target: 0.50
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, IWM]
    cadence: opportunistic
    rationale_template: "{underlying} in volatility squeeze. IV rank={iv_rank:.0f}, vol regime=LOW. Positioning for expansion."

  breakout_momentum:
    display_name: "Breakout — Bullish Momentum"
    description: "Price breaking above 52w high or key resistance with volume. Ride momentum with calls or debit spreads."
    scenario_type: breakout
    enabled: false
    trigger_conditions:
      directional_regime: ["U"]
      rsi_range: [55, 80]
      # Future: pct_from_52w_high > -1.0 (near or above 52w high)
      # Future: volume_ratio_min: 1.5 (above average volume)
    strategies:
      - strategy_type: vertical_spread
        option_type: call
        direction: buy
        dte_target: 30
        short_delta: 0.40
        wing_width_pct: 0.05
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
      - strategy_type: single
        option_type: call
        direction: buy
        dte_target: 45
        delta_target: 0.60
        confidence: 5
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, AAPL, NVDA, MSFT, AMZN, GOOGL]
    cadence: opportunistic
    rationale_template: "{underlying} breakout. RSI={rsi:.1f}, regime=UPTREND. Buying momentum with defined risk."

  breakdown_bearish:
    display_name: "Breakdown — Bearish Momentum"
    description: "Price breaking below key support with volume. Buy puts or bear call spreads."
    scenario_type: breakdown
    enabled: false
    trigger_conditions:
      directional_regime: ["D"]
      rsi_max: 40
      # Future: pct_from_52w_high_max: -10.0 (well below highs)
      # Future: below_sma_200: true
    strategies:
      - strategy_type: vertical_spread
        option_type: call
        direction: sell
        dte_target: 30
        short_delta: 0.25
        wing_width_pct: 0.05
        confidence: 6
        risk_category: defined
        route_to_portfolios: [tastytrade]
      - strategy_type: single
        option_type: put
        direction: buy
        dte_target: 45
        delta_target: 0.40
        confidence: 5
        risk_category: defined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, IWM]
    cadence: opportunistic
    rationale_template: "{underlying} breaking down. RSI={rsi:.1f}, regime=DOWNTREND. Positioning for continued weakness."

  consolidation_range_bound:
    display_name: "Consolidation — Range-Bound Premium Sell"
    description: "Market choppy, range-bound. Sell iron condors and strangles — collect theta in sideways market."
    scenario_type: consolidation
    enabled: false
    trigger_conditions:
      directional_regime: ["F"]
      volatility_regime: ["NORMAL", "LOW"]
      rsi_range: [40, 60]
      # Future: bollinger_width in [0.03, 0.06] (moderate, not squeezing)
    strategies:
      - strategy_type: iron_condor
        dte_target: 30
        short_delta: 0.20
        wing_width_pct: 0.06
        confidence: 7
        risk_category: defined
        route_to_portfolios: [tastytrade, fidelity_ira]
      - strategy_type: strangle
        direction: sell
        dte_target: 45
        delta_target: 0.16
        confidence: 5
        risk_category: undefined
        route_to_portfolios: [tastytrade]
    underlyings: [SPY, QQQ, IWM]
    cadence: opportunistic
    rationale_template: "{underlying} range-bound. RSI={rsi:.1f}, regime=FLAT, vol={volatility_regime}. Selling premium in consolidation."
